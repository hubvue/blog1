{"componentChunkName":"component---src-templates-blog-post-js","path":"/content/HTTP/http-to-https/","result":{"data":{"site":{"siteMetadata":{"title":"Kim Blog","author":"Kim"}},"markdownRemark":{"id":"4d670f8a-f674-5b02-b3e2-8fdc06fbd3a2","excerpt":"前言 目前大多数网站都是在用的 HTTPS，为什么要用 HTTPS 大家一定是都知道的，从 HTTP 升级到 HTTPS，也是为网站的安全性来考虑的。HTTPS 是在 HTTP 的基础上加上了 SSL 安全认证，是正所谓 HTTPS=HTTP + SSL…","html":"<h1>前言</h1>\n<p>目前大多数网站都是在用的 HTTPS，为什么要用 HTTPS 大家一定是都知道的，从 HTTP 升级到 HTTPS，也是为网站的安全性来考虑的。HTTPS 是在 HTTP 的基础上加上了 SSL 安全认证，是正所谓 HTTPS=HTTP + SSL。为了方面自己写文章，相信大多数同学都有搭建自己的个人博客(自己纯手写或者使用静态模板)，大多数应该是服务在自己的 Nginx 服务上或者使用 Github 托管，使用 Nginx 做代理的起初是通过 HTTP 来访问的，所以需要自己手动去配置成 HTTPS 的。</p>\n<p><strong>至于为什么推动我去做这件事情？原因有三点</strong></p>\n<ol>\n<li>当下 HTTPS 很流行</li>\n<li>自己搭建的网站当然要为网站的安全性考虑</li>\n<li>在面试过程中面试官问到了我 HTTPS 相关知识，并且是怎么从 HTTP 升级到 HTTPS 的</li>\n</ol>\n<h1>Start</h1>\n<h2>如何来获得证书</h2>\n<p>搭建 HTTPS 需要用到 SSL 证书，这个证书是由 CA 认证机构来颁发的，一般都是需要 RMB 的，当然也有一些免费的。<a href=\"https://freessl.cn/\">FreeSSL</a>就是一个提供免费 HTTPS 证书申请的网站，笔者就是从这上面申请的。</p>\n<p>首先进入这个网站的首页\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/63c5e798034e2124a1e7716b1bb440a0/66ab5/1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.31897265948633%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgT/xAAWAQEBAQAAAAAAAAAAAAAAAAADAAT/2gAMAwEAAhADEAAAAVbnq2PYiP8A/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEQAhH/2gAIAQEAAQUCycUQp//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/AWf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAEAAwEBAAAAAAAAAAAAAAABABExICH/2gAIAQEAAT8hA7caPNhZi8H/2gAMAwEAAgADAAAAEKs//8QAGBEAAgMAAAAAAAAAAAAAAAAAAAERIVH/2gAIAQMBAT8QeiXp/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAh/9oACAECAQE/EE2f/8QAGRABAAMBAQAAAAAAAAAAAAAAAQARYSBB/9oACAEBAAE/EG6KfKQgQFNMAUIx4P/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/63c5e798034e2124a1e7716b1bb440a0/88218/1.jpg\"\n        srcset=\"/static/63c5e798034e2124a1e7716b1bb440a0/7237a/1.jpg 148w,\n/static/63c5e798034e2124a1e7716b1bb440a0/0cfdf/1.jpg 295w,\n/static/63c5e798034e2124a1e7716b1bb440a0/88218/1.jpg 590w,\n/static/63c5e798034e2124a1e7716b1bb440a0/77d57/1.jpg 885w,\n/static/63c5e798034e2124a1e7716b1bb440a0/5a917/1.jpg 1180w,\n/static/63c5e798034e2124a1e7716b1bb440a0/66ab5/1.jpg 2414w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n可以看到有一个搜索框和一个(创建免费的 SSL 证书字样)按钮。在搜索框中输入你的域名，点击按钮进入证书创建页面。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fe7cdfb9117d515ab6e08c9ac7a13acb/f3d9c/2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.046614872364046%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAD/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAIDBP/aAAwDAQACEAMQAAABTxdsSqE//8QAGBAAAgMAAAAAAAAAAAAAAAAAABEgITH/2gAIAQEAAQUCo0UP/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAAgMaH/2gAIAQEABj8CmkX/xAAZEAEBAAMBAAAAAAAAAAAAAAABABARQXH/2gAIAQEAAT8hGyg4fcBht3//2gAMAwEAAgADAAAAEL8v/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEh/9oACAEDAQE/ELrX/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qh//EABoQAQEBAAMBAAAAAAAAAAAAAAEAESFRYbH/2gAIAQEAAT8QKD9rKHs5QZsk7tX/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/fe7cdfb9117d515ab6e08c9ac7a13acb/88218/2.jpg\"\n        srcset=\"/static/fe7cdfb9117d515ab6e08c9ac7a13acb/7237a/2.jpg 148w,\n/static/fe7cdfb9117d515ab6e08c9ac7a13acb/0cfdf/2.jpg 295w,\n/static/fe7cdfb9117d515ab6e08c9ac7a13acb/88218/2.jpg 590w,\n/static/fe7cdfb9117d515ab6e08c9ac7a13acb/77d57/2.jpg 885w,\n/static/fe7cdfb9117d515ab6e08c9ac7a13acb/5a917/2.jpg 1180w,\n/static/fe7cdfb9117d515ab6e08c9ac7a13acb/f3d9c/2.jpg 1802w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n在这里选择证书类型，笔者选择的就是图片上的。在验证类型上面，因为是第一次踩坑，第一次选择了 DNS，后续的认证没有通过，通过 Google 和看大佬们的踩坑日记之后，发现文件验证更过过一些，所以就尝试去选择文件验证。</p>\n<p>CSR 生成因为官网推荐，所以就选择了离线生成。</p>\n<p>输入邮箱之后点击创建，点击之后会提示打开 KeyManager，这个是用来管理证书的，如果自己电脑上没有可以去点进去官网下载。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ec4805bad3fda7678fc4b20d5fb5da0/f81f2/3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.62268803945746%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAS0sJmCjmf/EABsQAAICAwEAAAAAAAAAAAAAAAEDAAIEEBQx/9oACAEBAAEFAsRNWzjVGAVZTR9//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHRAAAQIHAAAAAAAAAAAAAAAAAQACERIgITFBkf/aAAgBAQAGPwJ00bLfU4DANH//xAAZEAADAQEBAAAAAAAAAAAAAAAAARFBMRD/2gAIAQEAAT8hZpkkcJ4fUIJG/Oh//9oADAMBAAIAAwAAABBLz//EABcRAQEBAQAAAAAAAAAAAAAAAAEAEVH/2gAIAQMBAT8QE5Zf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QSf/EAB0QAQADAAEFAAAAAAAAAAAAAAEAESExQVGBodH/2gAIAQEAAT8QBxVXdL+SpaIcrCGugN4ObOfjOjPYn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/3ec4805bad3fda7678fc4b20d5fb5da0/88218/3.jpg\"\n        srcset=\"/static/3ec4805bad3fda7678fc4b20d5fb5da0/7237a/3.jpg 148w,\n/static/3ec4805bad3fda7678fc4b20d5fb5da0/0cfdf/3.jpg 295w,\n/static/3ec4805bad3fda7678fc4b20d5fb5da0/88218/3.jpg 590w,\n/static/3ec4805bad3fda7678fc4b20d5fb5da0/77d57/3.jpg 885w,\n/static/3ec4805bad3fda7678fc4b20d5fb5da0/5a917/3.jpg 1180w,\n/static/3ec4805bad3fda7678fc4b20d5fb5da0/f81f2/3.jpg 1622w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n如果已经安装好了，点击<em>再次尝试启动 KeyManager</em>，就会启动这个应用，开启启动因为这是一个管理私密信息的平台，所以让你输入密码，进去之后就会提示<em>CSR 生成成功，请返回浏览器继续操作</em>。回到浏览器之后点击继续就会看到这样一个东西。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/80ee8ed0512f7e8782597531a7ff5089/200cc/4.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.84699453551913%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd1uSgD/xAAWEAADAAAAAAAAAAAAAAAAAAABECD/2gAIAQEAAQUCgL//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAERAhUQH/2gAIAQEAAT8htj7kIa3sf//aAAwDAQACAAMAAAAQ88//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAwEBPxCn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgMAAwAAAAAAAAAAAAAAAREAITEQYZH/2gAIAQEAAT8QYksc7PsAWQgY64UgQVcf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/80ee8ed0512f7e8782597531a7ff5089/88218/4.jpg\"\n        srcset=\"/static/80ee8ed0512f7e8782597531a7ff5089/7237a/4.jpg 148w,\n/static/80ee8ed0512f7e8782597531a7ff5089/0cfdf/4.jpg 295w,\n/static/80ee8ed0512f7e8782597531a7ff5089/88218/4.jpg 590w,\n/static/80ee8ed0512f7e8782597531a7ff5089/77d57/4.jpg 885w,\n/static/80ee8ed0512f7e8782597531a7ff5089/5a917/4.jpg 1180w,\n/static/80ee8ed0512f7e8782597531a7ff5089/200cc/4.jpg 1464w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n这是用来验证你的网站是否是可访问的。按照步骤验证即可</p>\n<ol>\n<li>先点击右下角的下载文件</li>\n<li>将文件保存在你的网站根目录的<em>.well-known/pki-validation</em>目录下，可以按照文件路径来配置。</li>\n<li>存在好之后自己在浏览器中访问一下是否是可访问的，可以访问就配置完成了。</li>\n<li>点击验证。</li>\n</ol>\n<p>验证通过之后就会看到证书信息，你看到的应该和这个不太一样(应该是有个通过 KeyManager 管理的按钮)\n<img src=\"https://51shenyun.cn/wp-content/uploads/2018/07/20180726150556_68614.jpg\"></p>\n<p>点击使用 KeyManager 管理，就可以使用那个管理平台来管理你的证书了。</p>\n<p>进入 KeyManager 证书管理就会看到你的证书。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eab6447e989630ec5b21a82520d1fdf8/a1f07/5.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.21739130434783%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUCAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAADAQL/2gAMAwEAAhADEAAAAdLVU3TNZMO//8QAFhAAAwAAAAAAAAAAAAAAAAAABBAy/9oACAEBAAEFAgZQEr//xAAWEQADAAAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8BEX//xAAXEQADAQAAAAAAAAAAAAAAAAABAxAy/9oACAECAQE/AW7M/8QAFhABAQEAAAAAAAAAAAAAAAAAAhBx/9oACAEBAAY/AnXt/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAFRsRAhMaH/2gAIAQEAAT8hfhKo3Ak5Z5FZ/9oADAMBAAIAAwAAABAv/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAAAETH/2gAIAQMBAT8QyR//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxAK/8QAGRAAAwADAAAAAAAAAAAAAAAAAAERECHh/9oACAEBAAE/EHN2xKXUiTEIf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/eab6447e989630ec5b21a82520d1fdf8/88218/5.jpg\"\n        srcset=\"/static/eab6447e989630ec5b21a82520d1fdf8/7237a/5.jpg 148w,\n/static/eab6447e989630ec5b21a82520d1fdf8/0cfdf/5.jpg 295w,\n/static/eab6447e989630ec5b21a82520d1fdf8/88218/5.jpg 590w,\n/static/eab6447e989630ec5b21a82520d1fdf8/77d57/5.jpg 885w,\n/static/eab6447e989630ec5b21a82520d1fdf8/5a917/5.jpg 1180w,\n/static/eab6447e989630ec5b21a82520d1fdf8/a1f07/5.jpg 2300w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n点击导出证书，选择相应的服务器，笔者是使用的 Nginx 服务器，选择 Nginx 就可以，点击导出就可以获得 SSL 证书。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/30d97124db0b23068a956038aac3814a/14b47/6.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.80365296803653%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7U0AZQAf/EABcQAAMBAAAAAAAAAAAAAAAAAAEQQRH/2gAIAQEAAQUCqqwP/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFhAAAwAAAAAAAAAAAAAAAAAAECAx/9oACAEBAAY/Amh//8QAGRABAAIDAAAAAAAAAAAAAAAAARARACEx/9oACAEBAAE/ITSy4saDICoBez//2gAMAwEAAgADAAAAEJPIAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABwQAQEAAgIDAAAAAAAAAAAAAAERACEQMVFx0f/aAAgBAQABPxAGhK+XALN5DKyFO4msCfeO1EAIvvn/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/30d97124db0b23068a956038aac3814a/88218/6.jpg\"\n        srcset=\"/static/30d97124db0b23068a956038aac3814a/7237a/6.jpg 148w,\n/static/30d97124db0b23068a956038aac3814a/0cfdf/6.jpg 295w,\n/static/30d97124db0b23068a956038aac3814a/88218/6.jpg 590w,\n/static/30d97124db0b23068a956038aac3814a/14b47/6.jpg 876w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>如何来配置 Nginx HTTPS</h2>\n<p>第一步获得证书已经完成，下面就需要进行配置了。服务器配置主要分为以下几步：</p>\n<ol>\n<li>将证书传送到你的服务器上</li>\n<li>修改 nginx.conf 文件配置</li>\n<li>云服务器 443 端口开发</li>\n<li>http 重定向到 https</li>\n<li>测试访问完成</li>\n</ol>\n<h3>1、将证书传送到你的服务器上</h3>\n<p>笔者是使用的腾讯云的服务器(阿里云也可以，都是学生价，便宜)，建议将证书放在便于管理的地方，建议放在<code class=\"language-text\">/etc/ssl</code>下，看名字也知道是用来存在 ssl 证书的。</p>\n<p>将证书传入到服务器上可以使用 Linux 的<code class=\"language-text\">scp</code>命令</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">#如果是文件\nscp 你的ssl证书文件  root@你的服务器ip:/etc/ssl\n# 如果是文件夹\nscp -r 你的ssl证书文件夹 root@你的服务器ip:/etc/ssl</code></pre></div>\n<p>如果传的是文件，进入服务器上进行解压，解压完成之后，就会得到两个文件：一个是<code class=\"language-text\">crt</code>后缀的，一个是<code class=\"language-text\">key</code>后缀的。</p>\n<h3>2、修改 nginx.conf 文件配置</h3>\n<p>将证书放在服务器上之后需要去修改 nginx.conf 配置。因为之前是使用的 80 端口，但是 HTTPS 使用的 443 端口，所以要修改一下。</p>\n<p>一般 Nginx 上都有 443 端口的配置，但是注释的，只要打开注释修改一点信息即可。</p>\n<p>下面是我的 443 端口的配置。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">server {\n    listen       443 ssl http2 default_server;\n    listen       [::]:443 ssl http2 default_server;\n    server_name  kim.cckim.cn;\n    root         /usr/share/nginx/html;\n\n    ssl_certificate &quot;/etc/ssl/xxxxx/xxxxx.crt&quot;;\n    ssl_certificate_key &quot;/etc/ssl/xxxxx/xxxxx.key&quot;;\n    ssl_session_cache shared:SSL:1m;\n    ssl_session_timeout  10m;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n\n    # Load configuration files for the default server block.\n    include /etc/nginx/default.d/*.conf;\n\n    location / {\n            root    /usr/share/nginx/html/public;\n            index   index.html;\n    }\n\n    error_page 404 /404.html;\n        location = /40x.html {\n    }\n}</code></pre></div>\n<p>将所有的注释打开，下面说一下需要修改的地方</p>\n<ol>\n<li>server<em>name：如果要 443 端口和 80 端口并存的话，建议写上 server</em>name，当命中这个域名的时候就会来找这个 server 配置。</li>\n<li>ssl_certificate：将 ssl 证书里面的 crt 后缀的文件的绝对路径写在这里。</li>\n<li>ssl<em>certificate</em>key：将 ssl 认证里面的 key 后缀的文件的绝对路径写在这里。</li>\n<li>配置你的网站的 location 代理。</li>\n</ol>\n<p>nginx.conf 上 443 端口的配置就基本完成了</p>\n<h3>3、 云服务器 443 端口开发</h3>\n<p>如果你的云服务器上没有开发 443 端口的话需要去服务器平台的安全组中开发 443 端口。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d62d00dba97cbfea3ced951ff8b0d909/e9d6a/7.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.67567567567567%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3qAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFhABAQEAAAAAAAAAAAAAAAAAARAR/9oACAEBAAE/IQwv/9oADAMBAAIAAwAAABAAL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAIDAQAAAAAAAAAAAAAAAAABESExcf/aAAgBAQABPxCoU6PhN4f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/d62d00dba97cbfea3ced951ff8b0d909/88218/7.jpg\"\n        srcset=\"/static/d62d00dba97cbfea3ced951ff8b0d909/7237a/7.jpg 148w,\n/static/d62d00dba97cbfea3ced951ff8b0d909/0cfdf/7.jpg 295w,\n/static/d62d00dba97cbfea3ced951ff8b0d909/88218/7.jpg 590w,\n/static/d62d00dba97cbfea3ced951ff8b0d909/77d57/7.jpg 885w,\n/static/d62d00dba97cbfea3ced951ff8b0d909/5a917/7.jpg 1180w,\n/static/d62d00dba97cbfea3ced951ff8b0d909/e9d6a/7.jpg 2960w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>操作完成之后就先访问一下，可能你会发现在浏览器中输入<code class=\"language-text\">kim.cckim.cn</code>(输入你的域名)是是无法访问的，但是输入<code class=\"language-text\">https://kim.cckim.cn</code>(还是输入你的域名)就可以访问。</p>\n<p>是因为域名到 nginx 默认走的是 http，还需要对 http 做一下重定向到 https 上。</p>\n<h3>4、http 重定向到 https</h3>\n<p>重定向只需要在 nginx.conf 文件中配置一下即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">server {\n    listen       80;\n    server_name  kim.cckim.cn;\n    return 301 https://$host$request_uri;\n}</code></pre></div>\n<p>这里 server_name 写你自己的域名即可。再次直接使用域名访问的话就可以了。</p>\n<h1>End</h1>\n<p>笔者应该是配置 HTTPS 比较靠后的一批了，相信已经有很多同学完成。这次把自己的配置过程记录向来，希望可以给没有配置过 HTTPS 的同学一些帮助。</p>","frontmatter":{"title":"记一次从HTTP升级HTTPS完全指南","date":"August 17, 2019","description":"在Nginx服务器上将自己的网站从HTTP升级到HTTPS的完全实战","category":"HTTP"}}},"pageContext":{"slug":"/content/HTTP/http-to-https/","previous":{"fields":{"slug":"/content/React/simple-redux/"},"frontmatter":{"title":"手写一个Redux-simple"}},"next":{"fields":{"slug":"/content/TypeScript/typescript-options/"},"frontmatter":{"title":"TypeScript的配置信息"}}}}}