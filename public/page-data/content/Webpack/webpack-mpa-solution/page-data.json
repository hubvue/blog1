{"componentChunkName":"component---src-templates-blog-post-js","path":"/content/Webpack/webpack-mpa-solution/","result":{"data":{"site":{"siteMetadata":{"title":"Kim Blog","author":"Kim"}},"markdownRemark":{"id":"8c1d2bd5-b936-52bf-ae3f-3b838e88da79","excerpt":"webpack æ‰“åŒ…å¤šé¡µçš„ç—›ç‚¹ æˆ‘ä»¬éƒ½çŸ¥é“å‰ç«¯è¿˜æœ‰ä¸€ä¸ªåå­—å« webpack é…ç½®å·¥ç¨‹å¸ˆï¼Œä¹Ÿè¡¨ç¤ºæˆ‘ä»¬å‰ç«¯åœ¨å†™é¡¹ç›®çš„æ—¶å€™ï¼Œå†™ webpack é…ç½®è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚\nå½“ webpack å»æ‰“åŒ…ä¸€ä¸ª SPA çš„æ—¶å€™è¿˜å¥½ï¼Œé…ç½®åªéœ€è¦å†™ä¸€éå°±å¯ä»¥äº†ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨ webpackâ€¦","html":"<h2>webpack æ‰“åŒ…å¤šé¡µçš„ç—›ç‚¹</h2>\n<p>æˆ‘ä»¬éƒ½çŸ¥é“å‰ç«¯è¿˜æœ‰ä¸€ä¸ªåå­—å« webpack é…ç½®å·¥ç¨‹å¸ˆï¼Œä¹Ÿè¡¨ç¤ºæˆ‘ä»¬å‰ç«¯åœ¨å†™é¡¹ç›®çš„æ—¶å€™ï¼Œå†™ webpack é…ç½®è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚\nå½“ webpack å»æ‰“åŒ…ä¸€ä¸ª SPA çš„æ—¶å€™è¿˜å¥½ï¼Œé…ç½®åªéœ€è¦å†™ä¸€éå°±å¯ä»¥äº†ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨ webpack å»æ‰“åŒ…å¤šé¡µï¼Œé‚£ä¹ˆé…ç½®çš„å·¥ä½œé‡å°†ä¼šç§©åºä¸‹å»ã€‚ä¾‹å¦‚ä¸‹é¢è¿™äº›é…ç½®ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  entry<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    index<span class=\"token punctuation\">:</span> <span class=\"token string\">'./src/index.js'</span><span class=\"token punctuation\">,</span>\n    about<span class=\"token punctuation\">:</span> <span class=\"token string\">'./src/index.js'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¸Šé¢æˆ‘ä»¬é…ç½®äº†ä¸¤ä¸ªå…¥å£ï¼Œå¦‚æœæ˜¯æ‰“åŒ…å¤šé¡µï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šæœ‰ä¸¤ä¸ª<code class=\"language-text\">HTMLWebpackPlugin</code>å»é…ç½® htmlã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">HtmlWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      filename<span class=\"token punctuation\">:</span> <span class=\"token string\">'index.html'</span><span class=\"token punctuation\">,</span>\n      template<span class=\"token punctuation\">:</span> <span class=\"token string\">'./src/index.html'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">HtmlWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      filename<span class=\"token punctuation\">:</span> <span class=\"token string\">'about.html'</span><span class=\"token punctuation\">,</span>\n      template<span class=\"token punctuation\">:</span> <span class=\"token string\">'./src/about.html'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åƒä¸Šé¢è¿™äº›é…ç½®ï¼Œæˆ‘ä»¬é…ç½®äº†ä¸¤ä¸ªé¡µé¢ï¼Œä½†æ˜¯å¦‚æœåé¢è¦ç»§ç»­æ·»åŠ éœ€æ±‚çš„è¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æ‰‹åŠ¨çš„å»é…ç½®æ–°çš„é¡µé¢ã€‚å›æƒ³ä¸€ä¸‹æˆ‘ä»¬ä½¿ç”¨ webpack çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼šé…ç½®å·¥ç¨‹åŒ–ï¼Œè§£æ”¾åŒæ‰‹ã€‚å¤šé¡µå¾ˆæ˜¾ç„¶å°±è¿èƒŒäº†æˆ‘ä»¬çš„ç†å¿µï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆæ–¹æ³•è§£å†³è¿™æ ·çš„é—®é¢˜å—ï¼Ÿå¾ˆæ˜¾ç„¶æ˜¯æœ‰çš„ã€‚</p>\n<h2>å¤šé¡µé¢æ‰“åŒ…æ–¹æ¡ˆ</h2>\n<blockquote>\n<p>å¯¹äºä»»ä½•é—®é¢˜ï¼Œéƒ½æœ‰ç‰¹å®šçš„è§„åˆ™å»è§£å†³ï¼Œè€Œæˆ‘ä»¬è§£å†³é—®é¢˜çš„è¿‡ç¨‹å°±æ˜¯å¯»æ‰¾è§„åˆ™çš„è¿‡ç¨‹ã€‚</p>\n</blockquote>\n<p>ä¸Šé¢è¯´äº†ä¸€å¥åè¨€ ğŸ˜†ï¼Œå½“ç„¶å¯¹äºæ‰“åŒ…å¤šé¡µä¹Ÿæ˜¯è¯•ç”¨çš„ã€‚</p>\n<p>æˆ‘ä»¬åªéœ€è¦è§„å®šç»Ÿä¸€ç›®å½•ç»“æ„ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æœ‰ä¸¤ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®å½•ç»“æ„å°±é…ç½®æˆ</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">src/pages/index/index.html\nsrc/pages/about/index.html</code></pre></div>\n<p>å¯¹äºä¸Šé¢ä¸¤ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬è®¾ç½®ä¸¤ä¸ªç‰¹å®šçš„å…¥å£ js å’Œ html æ–‡ä»¶æ”¾åœ¨ä¸€èµ·ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">src/pages/index/index.js\nsrc/pages/about/index.js</code></pre></div>\n<p>åœ¨ webpack ä¸­æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ç§è§„åˆ™é€šè¿‡æ­£åˆ™å»æ‰¾åˆ°å…¶ä¸­çš„ä¸åŒç‚¹ï¼šæ¯”å¦‚è¯´ index é¡µé¢çš„ pageName ä¸º indexï¼Œabout é¡µé¢çš„ pageName ä¸º aboutã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">setMpa</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> htmlPlugins <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">let</span> entrys <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> files <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">.</span><span class=\"token function\">sync</span><span class=\"token punctuation\">(</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/pages/**/*.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> file <span class=\"token keyword\">of</span> files<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> pageName <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/pages\\/[\\w\\W]*(?=\\/index.js)/</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    entrys<span class=\"token punctuation\">[</span>pageName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./src/pages/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pageName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/index.js</span><span class=\"token template-punctuation string\">`</span></span>\n    htmlPlugins<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">new</span> <span class=\"token class-name\">HtmlWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        template<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./src/pages/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pageName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/index.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        filename<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">pages/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pageName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        chunks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>pageName<span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    entrys<span class=\"token punctuation\">,</span>\n    htmlPlugins\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘ä»¬å°±å¯ä»¥å†™è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡æ­£åˆ™æ‹¿åˆ°ä¸åŒï¼ŒåŠ¨æ€çš„å»é…ç½® entry å’Œ HtmlWebpackPluginã€‚</p>\n<p>æ‰§è¡Œè¿™ä¸ªå‡½æ•°å°±å¯ä»¥å¾—åˆ° entrys å’Œ htmlPlugins</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> entrys<span class=\"token punctuation\">,</span> htmlPlugins <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">setMpa</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  entry<span class=\"token punctuation\">:</span> entrys<span class=\"token punctuation\">,</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>optimize<span class=\"token punctuation\">.</span>ModuleConcatenationPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">CleanWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>htmlPlugins<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™æ ·ä¹‹åè¦æ·»åŠ æ–°é¡µé¢ï¼Œåªè¦æŒ‰ç…§ç›®å½•çš„è§„åˆ™å»æ·»åŠ ï¼Œä¸å†éœ€è¦ä¿®æ”¹é…ç½®äº† ğŸ˜ã€‚</p>\n<h2>æ€»ç»“</h2>\n<p>å¯¹äº webpack æ‰“åŒ…å¤šé¡µçš„ç—›ç‚¹ï¼Œæˆ‘ä»¬è®¾è®¡å‡ºç»Ÿä¸€çš„è§„åˆ™å»è§£å†³ï¼Œæ€»ä½“è§„åˆ™å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>ç»Ÿä¸€ç›®å½•è§„èŒƒ</li>\n<li>ç»Ÿä¸€å…¥å£æ–‡ä»¶</li>\n<li>ä½¿ç”¨ glob.sync è·å–åˆ°æ‰€æœ‰å…¥å£æ–‡ä»¶</li>\n<li>æ­£åˆ™åŒ¹é…å¾—åˆ° pageName</li>\n<li>åŠ¨æ€è®¾ç½® entrys å’Œ htmlPlugins</li>\n</ul>","frontmatter":{"title":"webpackå¤šé¡µé¢æ‰“åŒ…æ–¹æ¡ˆ","date":"October 11, 2019","description":"åˆ†æwebpackæ‰“åŒ…å¤šé¡µçš„ç—›ç‚¹ï¼Œç»Ÿä¸€è§„åˆ™ï¼ŒåŠ¨æ€é…ç½®è§£å†³","category":"Webpack"}}},"pageContext":{"slug":"/content/Webpack/webpack-mpa-solution/","previous":{"fields":{"slug":"/content/design-pattern/node-ioc/"},"frontmatter":{"title":"IOCåœ¨Nodejsä¸Šçš„åˆä½“éªŒ"}},"next":{"fields":{"slug":"/content/Webpack/webpack-scope-hoisting/"},"frontmatter":{"title":"Webpackæ¨¡å—åŒ–çš„é—®é¢˜åŠScope hoistingåŸç†"}}}}}